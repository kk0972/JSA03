<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>JS Shopping Cart | Webdevtrick.com</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/foundation/5.0.2/css/foundation.css'>
    <link rel="stylesheet" href="style.css">
	<style>
		/*style của navbar*/
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        nav {
            background-color: aqua;
            height: 40px;
        }
        
        .max-width {
            max-width: 1300px;
            height: 40px;
            margin: 0;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
        
        .logo {
            width: 30px;
            height: 30px;
        }
        
        .logo img {
            width: 30px;
            height: 30px;
        }
        
        .max-width ul {
            width: 350px;
            text-decoration: none;
            display: flex;
            list-style: none;
            justify-content: space-between;
        }
        
        .max-width ul li {
            text-align: center;
            line-height: 40px;
            width: 50px;
            height: 40px;
            font-family: "SF Pro Display";
            font-weight: lighter;
        }
        
        .max-width ul li:hover {
            transition: 280ms;
            background-color: rgb(5, 255, 255);
            opacity: 0.85
        }
			@import url(//db.onlinewebfonts.com/c/3cff9206b4c8d578245ef1aaeeaf9e84?family=SF+Pro+Display);
        @font-face {
            font-family: "SF Pro Display";
            src: url("//db.onlinewebfonts.com/t/3cff9206b4c8d578245ef1aaeeaf9e84.eot");
            src: url("//db.onlinewebfonts.com/t/3cff9206b4c8d578245ef1aaeeaf9e84.eot?#iefix") format("embedded-opentype"), url("//db.onlinewebfonts.com/t/3cff9206b4c8d578245ef1aaeeaf9e84.woff2") format("woff2"), url("//db.onlinewebfonts.com/t/3cff9206b4c8d578245ef1aaeeaf9e84.woff") format("woff"), url("//db.onlinewebfonts.com/t/3cff9206b4c8d578245ef1aaeeaf9e84.ttf") format("truetype"), url("//db.onlinewebfonts.com/t/3cff9206b4c8d578245ef1aaeeaf9e84.svg#SF Pro Display") format("svg");
        }
    </style>
    <link rel="stylesheet" href="./Apple_files/fonts" type="text/css" media="all">
	</style>

</head>

<body>
	<link href="//db.onlinewebfonts.com/c/3cff9206b4c8d578245ef1aaeeaf9e84?family=SF+Pro+Display" rel="stylesheet" type="text/css" />
	<!--đây là navigation bar-->
        <nav>
            <div class="max-width">
                <div class="logo">
                    <img src="https://i.pinimg.com/originals/74/65/f3/7465f30319191e2729668875e7a557f2.png" alt="">
                </div>
                <ul class="menu">
                    <li>Home</li>
                    <li>Page</li>
                    <li>About</li>
                    <li>Contact</li>
                    <li>Cart</li>
                </ul>
            </div>
        </nav>
        <div>
        <div class="medium-4  columns">
            <div class="cart">
                <h1>GIỎ HÀNG</h1>
                <div class="row">
                    <div class="medium-6 columns">
                        <button class="tiny secondary" id="clear">XÓA TẤT CẢ</button>
                    </div>
                    <div class="medium-6 columns">
                        <button class="tiny disabled" title="Work in progress">THANH TOÁN</button>
                    </div>
                </div>
                <div id="cartItems">Loading cart...</div>
                Total price: <strong id="totalPrice">0 $</strong>
            </div>

        </div>
        <div class="medium-8 columns">
            <h1>Products List</h1>
            <div class="products">
                <div class="product medium-4 columns" data-name="Kemtron Thường" data-price="50000" data-id="0">
                    <img src="https://phongkhamhana.com/wp-content/uploads/2020/02/kem-tron.jpg" alt="" />
                    <h3>Kemtron Thường</h3>
                    <input type="number" class="count" value="1" />
                    <button class="tiny">Thêm vào giỏ hàng</button>
                </div>
                <div class="product medium-4 columns" data-name="Kemtron Xịn" data-price="85000" data-id="1">
                    <img src="https://trustreview.vn/wp-content/uploads/2020/02/kem-duong-trang-da-mat-tot.jpg" alt="" />
                    <h3>Kemtron Xịn</h3>
                    <input type="number" class="count" value="1" />
                    <button class="tiny">Thêm vào giỏ hàng</button>
                </div>
                <div class="product medium-4 columns" data-name="Kemtron Siêu Cấp Vip Pro" data-price="250000" data-id="2">
                    <img src="https://dep.com.vn/wp-content/uploads/2017/09/cledepeau_lacreme_deponline.jpg" alt="" />
                    <h3>Kemtron Siêu Cấp Vip Pro</h3>
                    <input type="number" class="count" value="1" />
                    <button class="tiny">Thêm vào giỏ hàng</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/template" id="cartT">
        <% _.each(items, function (item) { %>
            <div class="panel">
                <h3>
                    <%= item.name %>
                </h3> <span class="label">
<%= item.count %> piece<% if(item.count > 1)
{%>s
<%}%> for <%= item.total %>VNĐ</span > </div>
<% }); %>
</script>
 
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js'></script>
<script  src="function.js"></script>
<script>
    var cartId = "cart";
    
    var localAdapter = {
    
        saveCart: function (object) {
    
            var stringified = JSON.stringify(object);
            localStorage.setItem(cartId, stringified);
            return true;
    
        },
        getCart: function () {
    
            return JSON.parse(localStorage.getItem(cartId));
    
        },
        clearCart: function () {
    
            localStorage.removeItem(cartId);
    
        }
    
    };
    
    var ajaxAdapter = {
    
        saveCart: function (object) {
    
            var stringified = JSON.stringify(object);
            // do an ajax request here
    
        },
        getCart: function () {
    
            // do an ajax request -- recognize user by cookie / ip / session
            return JSON.parse(data);
    
        },
        clearCart: function () {
    
            //do an ajax request here
    
        }
    
    };
    
    var storage = localAdapter;
    
    var helpers = {
    
        getHtml: function (id) {
    
            return document.getElementById(id).innerHTML;
    
        },
        setHtml: function (id, html) {
    
            document.getElementById(id).innerHTML = html;
            return true;
    
        },
        itemData: function (object) {
    
            var count = object.querySelector(".count"),
                patt = new RegExp("^[1-9]([0-9]+)?$");
            count.value = (patt.test(count.value) === true) ? parseInt(count.value) : 1;
    
            var item = {
    
                name: object.getAttribute('data-name'),
                price: object.getAttribute('data-price'),
                id: object.getAttribute('data-id'),
                count: count.value,
                total: parseInt(object.getAttribute('data-price')) * parseInt(count.value)
    
            };
            return item;
    
        },
        updateView: function () {
    
            var items = cart.getItems(),
                template = this.getHtml('cartT'),
                compiled = _.template(template, {
                    items: items
                });
            this.setHtml('cartItems', compiled);
            this.updateTotal();
    
        },
        emptyView: function () {
    
            this.setHtml('cartItems', '<p>Add some items to see</p>');
            this.updateTotal();
    
        },
        updateTotal: function () {
    
            this.setHtml('totalPrice', cart.total + 'VNĐ');
    
        }
    
    };
    
    var cart = {
    
        count: 0,
        total: 0,
        items: [],
        getItems: function () {
    
            return this.items;
    
        },
        setItems: function (items) {
    
            this.items = items;
            for (var i = 0; i < this.items.length; i++) {
                var _item = this.items[i];
                this.total += _item.total;
            }
    
        },
        clearItems: function () {
    
            this.items = [];
            this.total = 0;
            storage.clearCart();
            helpers.emptyView();
    
        },
        addItem: function (item) {
    
            if (this.containsItem(item.id) === false) {
    
                this.items.push({
                    id: item.id,
                    name: item.name,
                    price: item.price,
                    count: item.count,
                    total: item.price * item.count
                });
    
                storage.saveCart(this.items);
    
    
            } else {
    
                this.updateItem(item);
    
            }
            this.total += item.price * item.count;
            this.count += item.count;
            helpers.updateView();
    
        },
        containsItem: function (id) {
    
            if (this.items === undefined) {
                return false;
            }
    
            for (var i = 0; i < this.items.length; i++) {
    
                var _item = this.items[i];
    
                if (id == _item.id) {
                    return true;
                }
    
            }
            return false;
    
        },
        updateItem: function (object) {
    
            for (var i = 0; i < this.items.length; i++) {
    
                var _item = this.items[i];
    
                if (object.id === _item.id) {
    
                    _item.count = parseInt(object.count) + parseInt(_item.count);
                    _item.total = parseInt(object.total) + parseInt(_item.total);
                    this.items[i] = _item;
                    storage.saveCart(this.items);
    
                }
    
            }
    
        }
    
    };
    
    document.addEventListener('DOMContentLoaded', function () {
    
        if (storage.getCart()) {
    
            cart.setItems(storage.getCart());
            helpers.updateView();
    
        } else {
    
            helpers.emptyView();
    
        }
        var products = document.querySelectorAll('.product button');
        [].forEach.call(products, function (product) {
    
            product.addEventListener('click', function (e) {
    
                var item = helpers.itemData(this.parentNode);
                cart.addItem(item);
    
    
            });
    
        });
    
        document.querySelector('#clear').addEventListener('click', function (e) {
    
            cart.clearItems();
    
        });
    
    
    });
</script>
 
</body>
</html>